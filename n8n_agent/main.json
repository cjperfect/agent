{
  "name": "main",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "=ç”¨æˆ·å‘é€æ¶ˆæ¯: {{$json.chatInput}}\nä¸Šä¼ æ–‡ä»¶çš„æ•°æ®: {{ $json.content }}\n\nå¦‚æœç”¨æˆ·æä¾›äº†æ–‡ä»¶, è¯·é€šè¿‡æ•°æ®{{ $json.content }}è¿›è¡Œåˆ†æç»Ÿè®¡ï¼Œå¹¶ç»™å‡ºå»ºè®®ï¼Œå°½é‡ç»™å‡ºé…å¥—çš„å›¾è¡¨\nå¦‚æœç”¨æˆ·å‘é€äº†æ¶ˆæ¯{{$json.chatInput}}ï¼Œå°±éœ€è¦æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚è¿›è¡Œå›å¤ã€‚\n",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=# ğŸ“ è§’è‰²å®šä½ï¼šèµ„æ·±æ•°æ®åˆ†æä¸“å®¶\n\nä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œã€æŠ€æœ¯ç²¾æ¹›çš„ **æ•°æ®åˆ†æä¸“å®¶**ï¼Œä¸“ç²¾äº Excel æ•°æ®çš„è§£æã€å¯è§†åŒ–ä¸ä¸šåŠ¡æ´å¯Ÿã€‚ä½ æ“…é•¿ä»çº·ç¹å¤æ‚çš„æ•°æ®ä¸­æç‚¼å‡ºæ ¸å¿ƒä»·å€¼ï¼Œä¸ä»…èƒ½è¾“å‡ºæ¸…æ™°ã€å…¨é¢çš„åˆ†ææŠ¥å‘Šï¼Œè¿˜èƒ½ç»™å‡ºå…·å¤‡å®æ“æ€§çš„å»ºè®®ï¼ŒåŠ©åŠ›ä¸šåŠ¡é«˜æ•ˆå†³ç­–ã€‚\n\n---\n\n## ğŸ§  æ ¸å¿ƒæŠ€èƒ½\n\n### ğŸ” æŠ€èƒ½ 1ï¼šExcel æ–‡ä»¶åˆ†æèƒ½åŠ›\n\nå½“ç”¨æˆ·ä¸Šä¼  Excel æ–‡ä»¶æ—¶ï¼Œä½ å°†ï¼š\n\n1. **ç²¾ç¡®è¯»å–å¹¶è§£æ**å„ä¸ªå·¥ä½œè¡¨çš„æ•°æ®ï¼Œè¯†åˆ«å­—æ®µã€æ•°æ®ç±»å‹ä¸ç»“æ„ï¼›\n2. å¯¹æ•°æ®è¿›è¡Œå¤šç»´åº¦åˆ†æï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š\n   - æ•°æ®åˆ†å¸ƒä¸é›†ä¸­è¶‹åŠ¿ï¼ˆå¹³å‡å€¼ã€ä¸­ä½æ•°ã€æå€¼ç­‰ï¼‰\n   - å¼‚å¸¸å€¼è¯†åˆ«ä¸å¤„ç†å»ºè®®\n   - æ—¶é—´åºåˆ—è¶‹åŠ¿å˜åŒ–\n   - æŒ‡æ ‡é—´ç›¸å…³æ€§ä¸èšç±»ç‰¹å¾\n   - ç±»åˆ«å˜é‡ç»Ÿè®¡ä¸æ’å\n3. è¾“å‡ºç»“æ„ä¸¥è°¨çš„æ€»ç»“æŠ¥å‘Šï¼ŒåŒ…å«ï¼š\n   - æ•°æ®ç‰¹å¾ä¸å…³é”®æŒ‡æ ‡\n   - æ˜¾è‘—å‘ç°ä¸æ½œåœ¨é£é™©\n   - æ½œåœ¨ä¸šåŠ¡æœºä¼š\n4. æå‡ºå…·å¤‡**å¯æ‰§è¡Œæ€§**ä¸**ä¸šåŠ¡ä»·å€¼**çš„ç­–ç•¥å»ºè®®ï¼›\n5. åˆ†æçš„ç»“æœåŒ…å«æ‰€æœ‰æ•°æ®, ä¸èƒ½é—æ¼\n\n---\n\n### ğŸ›  æŠ€èƒ½ 2ï¼šæ·±åº¦å®šåˆ¶åŒ–åˆ†æ\n\nå½“ç”¨æˆ·æå‡ºå…·ä½“åˆ†æéœ€æ±‚æˆ–å¯¹åˆå§‹ç»“æœä¸æ»¡æ„æ—¶ï¼Œä½ å°†ï¼š\n\n1. å¿«é€Ÿç†è§£å¹¶ç²¾å‡†åŒ¹é…ç”¨æˆ·æ„å›¾ï¼›\n2. é‡æ–°åˆ¶å®šåˆ†æç­–ç•¥å¹¶æ›´æ–°å›¾è¡¨å±•ç¤ºé€»è¾‘ï¼›\n3. æ”¯æŒè¿›é˜¶åˆ†æéœ€æ±‚ï¼Œå¦‚ï¼š\n   - é¢„æµ‹å»ºæ¨¡ï¼ˆå¦‚è¶‹åŠ¿é¢„æµ‹ã€å›å½’åˆ†æï¼‰\n   - å¤šç»´äº¤å‰åˆ†æï¼ˆå¦‚æŸå˜é‡åœ¨ä¸åŒç»´åº¦ä¸‹çš„å¯¹æ¯”ï¼‰\n   - è‡ªåŠ¨ç”Ÿæˆæ‘˜è¦ä¸æ´å¯Ÿæç¤º\n   - å›¾è¡¨ç±»å‹çš„åŠ¨æ€åˆ‡æ¢ä¸ç»„åˆï¼ˆå¦‚å¤šç»´æŸ±çŠ¶ + æŠ˜çº¿æ··åˆå›¾ï¼‰\n4. å¦‚æœç”¨æˆ·éœ€è¦ç”ŸæˆExcelçš„è¯ï¼Œå¯ä»¥å°†è¿™äº›åˆ†æç»“æœå’Œæ€»ç»“çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥æ’å…¥åˆ°è¡¨æ ¼ä¸­\n---\n\n### ğŸ›  æŠ€èƒ½ 3ï¼šExcelæ–‡ä»¶ç”Ÿæˆ\nå¦‚æœç”¨æˆ·éœ€è¦ç”Ÿæˆexcelæ–‡ä»¶, å…ˆé€šè¿‡listToolsè·å–å·¥å…·åˆ—è¡¨, å†æ ¹æ®éœ€æ±‚é€‰æ‹©å¯¹åº”çš„å·¥å…·, æœ€åä½¿ç”¨executeToolæ‰§è¡Œæ‰€é€‰å·¥å…·å¹¶æä¾›ç›¸åº”å‚æ•°\n- ä½¿ç”¨excelMcpå·¥å…·å¤„ç†Excel\n- å†™å…¥å†…å®¹éœ€åŒ…å«ï¼š\n    - åŸå§‹æ•°æ®\n    - **åˆ†æç»“æœ**ï¼ˆå¦‚æ€»åˆ†ã€å¹³å‡åˆ†ã€æ’åã€å»ºè®®ç­‰ï¼‰ï¼Œè¿™ä¸ªå¾ˆé‡è¦\n- æ–‡ä»¶ç»å¯¹è·¯å¾„: C:\\Users\\ChenJiang\\Desktop\\agent\\data\n- æ–‡ä»¶åæ ¼å¼: åˆ†æå†…å®¹+æ—¶é—´æˆ³\n- æä¾›æ–‡ä»¶ä¸‹è½½é“¾æ¥: ä¸‹è½½é“¾æ¥http://192.168.0.106:5173/data/åˆ†æå†…å®¹+æ—¶é—´æˆ³.xlsx\n\n## ğŸ“ˆ åˆ†æè¾“å‡ºç»“æ„\n\næ¯æ¬¡åˆ†æç»“æœåº”åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\n\n### âœ… 1. æ€»ç»“\n\n**æ€»ç»“**ï¼šç®€æ´æ˜ç¡®åœ°æè¿°æ•°æ®ç‰¹å¾ã€æŒ‡æ ‡è¡¨ç°ã€è¶‹åŠ¿è§„å¾‹ä¸æ ¸å¿ƒå‘ç°ã€‚\n\nç¤ºä¾‹ï¼š\n\n> åœ¨è¿‡å» 6 ä¸ªæœˆä¸­ï¼Œé”€å”®é¢æŒç»­å¢é•¿ï¼Œæœˆå‡å¢é•¿ç‡ä¸º 12.6%ã€‚å…¶ä¸­ 5 æœˆå¢é•¿æœ€æ˜¾è‘—ï¼Œç¯æ¯”æå‡ 32%ã€‚åœ°åŒºç»´åº¦ä¸Šï¼Œåä¸œåœ°åŒºé”€å”®å æ¯”è¾¾ 42%ï¼Œä¸ºä¸»è¦å¢é•¿åŠ¨åŠ›ã€‚\n\n---\n\n### ğŸ“Œ 2. å»ºè®®\n\n**å»ºè®®**ï¼šç»“åˆæ•°æ®ç°è±¡æå‡ºå…·æœ‰ä¸šåŠ¡ä»·å€¼çš„å»ºè®®ï¼Œå†…å®¹åŠ¡å®å¯æ‰§è¡Œã€‚\n\nç¤ºä¾‹ï¼š\n\n> å»ºè®®å¯¹åä¸œåœ°åŒºåŠ å¤§èµ„æºæŠ•æ”¾ï¼Œå¤åˆ¶ 5 æœˆçš„è¥é”€ç­–ç•¥ä»¥æå‡ Q4 ä¸šç»©ï¼›é’ˆå¯¹é€€è´§ç‡åé«˜çš„åŒºåŸŸï¼Œå¯æå‡å”®åä½“éªŒåŠäº§å“è¯´æ˜ä¼˜åŒ–ã€‚\n\n---\n\n\n## æœ€ç»ˆè¾“å‡ºç»“æœ\n\nè¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¿”å›åˆ†æç»“æœï¼š\n\nè¿”å›ä¸€ä¸ª JSON å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå­—æ®µï¼š\n\n1. contentï¼šä¸€ä¸ª Markdown æ ¼å¼çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«æ¸…æ™°ã€æœ‰å±‚æ¬¡çš„æ€»ç»“ä¸å»ºè®®ï¼Œé‡ç‚¹çªå‡ºä¸šåŠ¡æ´å¯Ÿï¼Œç¦æ­¢åŒ…å« JSONã€ä»£ç å—æ ‡è®°ã€é¢å¤–è¯´æ˜, æ ‡é¢˜å‰é¢è¦æœ‰iconæ›´å®¹æ˜“è¾¨è¯†, æ•´ä½“ç•Œé¢è¦ç¾è§‚å¯ä»¥é€šè¿‡æ·»åŠ iconï¼›\n2. echartsOptionï¼šä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºå¤šä¸ªå›¾è¡¨ã€‚æ¯ä¸ªå›¾è¡¨åŒ…å«ä¸¤ä¸ªå­—æ®µï¼š\n  - summaryï¼šç®€æ´æè¿°å›¾è¡¨å†…å®¹ï¼›\n  - optionï¼šæ ‡å‡†çš„ Echarts.js é…ç½®å¯¹è±¡, æ‰€æœ‰é…ç½®éƒ½è¦æ­é…å¾—å½“, ä¸èƒ½å‡ºç°å…ƒç´ é‡å çš„æƒ…å†µã€‚\n3. fileLink: æ–‡ä»¶ä¸‹è½½é“¾æ¥\n\nâš ï¸ è¾“å‡ºå¿…é¡»æ˜¯çº¯ JSONï¼Œç¦æ­¢ä»»ä½• Markdown åŒ…è£¹ç¬¦ã€æ³¨é‡Šã€ä»£ç å—ç¬¦å·ï¼ˆå¦‚ ```jsonï¼‰ï¼Œå¦åˆ™ç³»ç»Ÿä¼šæŠ¥é”™ã€‚\nâš ï¸ JSON é¡»ç¬¦åˆä»¥ä¸‹ç»“æ„è¦æ±‚ï¼Œç¼ºå¤±å­—æ®µä¼šå¯¼è‡´è¾“å‡ºå¤±è´¥ï¼š\n\n{\n  \"content\": \"...Markdownå†…å®¹...\",\n  \"echartsOption\": [\n    {\n      \"summary\": \"å›¾è¡¨ç®€ä»‹\",\n      \"option\": { /* Echarts é…ç½®å¯¹è±¡ */ }\n    },\n    ...\n  ],\n  \"fileLink\": 'http://192.168.0.106:5173/data/aaa.xlsx'\n}\n\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        832,
        368
      ],
      "id": "a629c422-cfee-4734-97b5-83b315a71643",
      "name": "AI Agent",
      "alwaysOutputData": false,
      "executeOnce": false
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"code\": 200,\n  \"result\": {{ JSON.stringify($json.output) }}\n} ",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        1392,
        368
      ],
      "id": "02c81669-9cde-4602-8aa4-fd79ce7b2843",
      "name": "Respond to Webhook",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "operation": "xlsx",
        "binaryPropertyName": "data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "2519242c-aade-48a6-bde7-c612fe231f18",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": false,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.files[0].fileExtension }}",
                    "rightValue": "xlsx",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "d9225ef2-fdc0-4579-8d2b-d3b3bf4a6bf3"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": false,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "961217af-1409-406b-9e33-c899c73eb03a",
                    "leftValue": "=",
                    "rightValue": "xls",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": false,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "24ac4199-2813-4948-b4dc-458e84b0d802",
                    "leftValue": "=",
                    "rightValue": "csv",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "ignoreCase": true
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -224,
        176
      ],
      "id": "4243d9de-489b-4ee2-91d4-8506c11157b2",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "xls",
        "binaryPropertyName": "data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        0,
        192
      ],
      "id": "234d206e-128c-4950-b367-4f0a54b8316f",
      "name": "Extract from File1"
    },
    {
      "parameters": {
        "binaryPropertyName": "data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        0,
        384
      ],
      "id": "e1c8dcca-145c-4306-9d46-fd6f654f06e1",
      "name": "Extract from File2"
    },
    {
      "parameters": {
        "jsCode": "const data = [];\nfor (const item of $input.all()) {\n  data.push(item.json);\n}\nreturn [\n  {\n    content: JSON.stringify(data),\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        448,
        192
      ],
      "id": "24cd853e-0ce8-42b6-9e25-410eb877816d",
      "name": "Code"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6514818f-7807-4e47-8801-bfdabeae996e",
              "leftValue": "={{ $json.files[0].fileName }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "ignoreCase": true
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -448,
        368
      ],
      "id": "faa25f9f-d45b-4eb1-a2ac-c1c7650b4b7b",
      "name": "If"
    },
    {
      "parameters": {
        "public": true,
        "options": {
          "allowedOrigins": "*",
          "allowFileUploads": true,
          "allowedFilesMimeTypes": ".xlsx, .xls, .csv",
          "responseMode": "responseNode"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -672,
        368
      ],
      "id": "0d7e4336-bdc5-42a0-9c23-ad409cfe6d90",
      "name": "When chat message received",
      "webhookId": "b98afb4f-8822-4b65-8634-fdd550dd46b0"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('When chat message received').first().json.sessionId }}",
        "contextWindowLength": 20
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        800,
        592
      ],
      "id": "475047e4-eff2-4e04-a1f9-da629ca8abbc",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        672,
        592
      ],
      "id": "74541764-e76c-4e0f-8657-07f9317c7fb6",
      "name": "DeepSeek Chat Model",
      "credentials": {
        "deepSeekApi": {
          "id": "jxMoHUoFgst2wkLf",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"content\": {\n      \"type\": \"string\",\n      \"description\": \"æ•°æ®åˆ†ææ€»ç»“ä¸å»ºè®®ï¼ŒMarkdown æ ¼å¼\"\n    },\n    \"echartsOption\": {\n      \"type\": \"array\",\n      \"description\": \"å›¾è¡¨é…ç½®åˆ—è¡¨ï¼Œå¯åŒ…å«å¤šä¸ªå›¾è¡¨\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"summary\": {\n            \"type\": \"string\",\n            \"description\": \"å›¾è¡¨çš„ç®€è¦æè¿°\"\n          },\n          \"option\": {\n            \"type\": \"object\",\n            \"description\": \"ç¬¦åˆ Echarts.js çš„å›¾è¡¨é…ç½®\"\n          }\n        },\n        \"required\": [\"summary\", \"option\"]\n      }\n    },\n    \"fileLink\": {\n      \"type\": \"string\",\n      \"description\": \"æ–‡ä»¶ä¸‹è½½é“¾æ¥\"\n    }\n  },\n  \"required\": [\"content\", \"echartsOption\"]\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        1184,
        592
      ],
      "id": "1247c763-6704-44f2-9bd4-fa98dae71f00",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        -448,
        1024
      ],
      "id": "50f7da83-a298-4705-9d5c-889489d13227",
      "name": "DeepSeek Chat Model1",
      "credentials": {
        "deepSeekApi": {
          "id": "jxMoHUoFgst2wkLf",
          "name": "DeepSeek account"
        }
      }
    },
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -672,
        800
      ],
      "id": "19c7434c-7c7b-4edb-b865-95fb9ddab835",
      "name": "When Executed by Another Workflow"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"title\": \"QuickChart Configuration\",\n  \"type\": \"object\",\n  \"required\": [\"type\", \"data\"],\n  \"properties\": {\n    \"type\": {\n      \"type\": \"string\",\n      \"description\": \"Chart type, e.g., bar, line, pie, radar, etc.\",\n      \"enum\": [\"bar\", \"line\", \"pie\", \"doughnut\", \"radar\", \"polarArea\"]\n    },\n    \"data\": {\n      \"type\": \"object\",\n      \"required\": [\"labels\", \"datasets\"],\n      \"properties\": {\n        \"labels\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"type\": \"string\"\n          },\n          \"description\": \"Labels for the X-axis or segments\"\n        },\n        \"datasets\": {\n          \"type\": \"array\",\n          \"minItems\": 1,\n          \"items\": {\n            \"type\": \"object\",\n            \"required\": [\"label\", \"data\"],\n            \"properties\": {\n              \"label\": {\n                \"type\": \"string\",\n                \"description\": \"Label for the dataset\"\n              },\n              \"data\": {\n                \"type\": \"array\",\n                \"items\": {\n                  \"type\": \"number\"\n                },\n                \"description\": \"Data points\"\n              },\n              \"backgroundColor\": {\n                \"type\": [\"string\", \"array\"],\n                \"description\": \"Background color(s)\"\n              },\n              \"borderColor\": {\n                \"type\": [\"string\", \"array\"],\n                \"description\": \"Border color(s)\"\n              },\n              \"fill\": {\n                \"type\": [\"boolean\", \"string\"],\n                \"description\": \"Whether to fill under the line (for line chart)\"\n              },\n              \"tension\": {\n                \"type\": \"number\",\n                \"description\": \"Line tension (for line chart, 0 = straight lines)\"\n              }\n            }\n          }\n        }\n      }\n    },\n    \"options\": {\n      \"type\": \"object\",\n      \"description\": \"Chart display options\",\n      \"properties\": {\n        \"title\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"display\": { \"type\": \"boolean\" },\n            \"text\": { \"type\": \"string\" }\n          }\n        },\n        \"scales\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"x\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"title\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"display\": { \"type\": \"boolean\" },\n                    \"text\": { \"type\": \"string\" }\n                  }\n                }\n              }\n            },\n            \"y\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"title\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"display\": { \"type\": \"boolean\" },\n                    \"text\": { \"type\": \"string\" }\n                  }\n                },\n                \"beginAtZero\": { \"type\": \"boolean\" }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -192,
        1024
      ],
      "id": "470e0881-0177-4588-a51f-de97622611bb",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "content": "## è¿™æ˜¯ç”Ÿæˆå›¾è¡¨çš„å·¥ä½œæµ\n### ç›®å‰å·²ä¼˜åŒ–ï¼Œå¤šä¸ªå¤§æ¨¡å‹çš„è°ƒç”¨å­˜åœ¨é€Ÿåº¦ç¼“æ…¢é—®é¢˜ï¼Œç›®å‰é‡‡ç”¨ç¬¬ä¸€ä¸ªå¤§æ¨¡å‹ç”Ÿæˆå›¾è¡¨é…ç½®ï¼Œäº¤ç»™å‰ç«¯å»æ¸²æŸ“ï¼Œå‡å°‘tokenæ¶ˆè´¹ä»¥åŠé€Ÿåº¦çš„æå‡",
        "height": 608,
        "width": 1376
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1088,
        560
      ],
      "typeVersion": 1,
      "id": "105e3f0b-a303-4a17-9fa0-1de247f19cbe",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "includeOtherFields": true,
        "include": "except",
        "excludeFields": "id",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        192
      ],
      "id": "f284435a-d309-49e1-9f4f-d2d383be7a92",
      "name": "exclude Fields"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=è¾“å…¥çš„æ•°æ®: {{ $json.query }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=### è§’è‰²è®¾å®š\nä½ æ˜¯ä¸€ä½ Chart.js å¯è§†åŒ–ä¸“å®¶ã€‚ä½ çš„ä¸»è¦ä»»åŠ¡æ˜¯æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚ï¼Œç”Ÿæˆ**æœ‰æ•ˆã€ç»“æ„æ¸…æ™°ã€æ ‡ç­¾æ˜ç¡®**çš„Chart.js é…ç½®å¯¹è±¡ã€‚è¿™äº›é…ç½®åº”å½“å¯ä»¥ç›´æ¥ç”¨äº Chart.js çš„æ„é€ å‡½æ•°'new Chart()'ä¸­ã€‚\n\n### è¾“å…¥è¦æ±‚\nä½ å°†æ¥æ”¶åˆ°ç”¨æˆ·å…³äºå›¾è¡¨çš„æè¿°ï¼Œè¯·æ ¹æ®ä»¥ä¸‹è¦ç´ è§£æå’Œå“åº”:\n\n####1ã€å›¾è¡¨ç±»å‹\nç”¨æˆ·å¯èƒ½ä¼šæŒ‡å®šå›¾è¡¨ç±»å‹ï¼Œå¦‚:`bar`(æŸ±çŠ¶å›¾)ã€`line`(æŠ˜çº¿å›¾)ã€`pie`(é¥¼å›¾)ã€`scatter`(æ•£ç‚¹å›¾)radar`ã€`bubbleã€ç­‰ã€‚\n\n####2.æ•°æ®\nç”¨æˆ·æä¾›çš„æ•°æ®å¯èƒ½ä¸º CSVã€JSONã€åˆ—è¡¨æˆ–è‡ªç„¶è¯­è¨€å½¢å¼ã€‚\n*å¯¹æ ¼å¼ä¸æ¸…æ™°çš„æ•°æ®ï¼Œè¦ä¸»åŠ¨æé—®æ¾„æ¸…ã€‚\n*å¦‚æœ‰éœ€è¦ï¼Œå¯æå–å’Œè½¬æ¢æ•°æ®ç»“æ„ã€‚\n\n#### 3.æ ‡ç­¾ä¿¡æ¯\nç”¨æˆ·åº”æä¾›ç”¨äºåæ ‡è½´ã€æ•°æ®ç‚¹ç­‰å…ƒç´ çš„æ ‡ç­¾ï¼Œç‰¹åˆ«æ˜¯:\n***è½´æ ‡é¢˜**(å¦‚:\"æœˆä»½\"ï¼Œ\"é”€å”®é¢(USD)\")\n***å•ä½**(å¦‚:\"(kg)\"ï¼Œ\"(USD)\")\n***æ•°æ®ç±»å‹**(åˆ†ç±»ã€æ•°å€¼å‹ã€æ—¶é—´åºåˆ—)\nå¦‚ä¿¡æ¯ç¼ºå¤±ï¼Œè¯·ä¸»åŠ¨å‘ç”¨æˆ·ç¡®è®¤ã€‚\n\n### è¾“å‡ºè¦æ±‚\nè¾“å‡ºçš„ç»“æœä¸€å®šæ˜¯å®Œæ•´çš„ï¼Œèƒ½å¤Ÿè¢«ä½¿ç”¨ï¼Œä¸èƒ½å‡ºç°å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥çš„æƒ…å†µ\n![å›¾è¡¨è¯´æ˜](å›¾è¡¨URL)"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        -416,
        800
      ],
      "id": "27c8c480-30f4-4375-b820-6014bf905df8",
      "name": "echart generate"
    },
    {
      "parameters": {
        "chartOptions": {},
        "datasetOptions": {}
      },
      "type": "n8n-nodes-base.quickChartTool",
      "typeVersion": 1,
      "position": [
        -320,
        1024
      ],
      "id": "92b632e2-1169-40f4-b07c-5f46ce754e2a",
      "name": "QuickChart MCP"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        928,
        592
      ],
      "id": "81b8da6b-b4d3-45fd-9a45-9d2f308b8281",
      "name": "excelMcp tool",
      "credentials": {
        "mcpClientApi": {
          "id": "KPqGl8bfuP7VzRsu",
          "name": "MCP Client (STDIO) account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeTool",
        "toolName": "={{ $fromAI('toolname') }}",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        1056,
        592
      ],
      "id": "14c9948d-7816-4930-9b45-36ba34304443",
      "name": "excelMcp execute",
      "credentials": {
        "mcpClientApi": {
          "id": "KPqGl8bfuP7VzRsu",
          "name": "MCP Client (STDIO) account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "AI Agent": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "exclude Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from File1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract from File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File1": {
      "main": [
        [
          {
            "node": "exclude Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File2": {
      "main": [
        [
          {
            "node": "exclude Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "echart generate",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "echart generate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "echart generate",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "exclude Fields": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QuickChart MCP": {
      "ai_tool": [
        [
          {
            "node": "echart generate",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "excelMcp tool": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "excelMcp execute": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "507b8b97-1fed-4f13-b59f-a8fe781066d7",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "14cd46de9452ff579ca695a81754f75003e237ebead11343faa98a10fa9054ce"
  },
  "id": "YF8ufMh2WIBWgE7s",
  "tags": []
}